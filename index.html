<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>The Last Battery - Made by Shlok the Great</title>
  <style>
    body {
      background-color: #0a0a0a;
      color: white;
      font-family: 'Courier New', monospace;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
      overflow: hidden;
    }

    #game {
      position: relative;
      width: 400px;
      height: 400px;
      background: #1a1a1a;
      border: 2px solid #00ff99;
      box-shadow: 0 0 20px #00ff99;
      overflow: hidden;
    }

    .robot {
      width: 30px;
      height: 30px;
      background: #00ffcc;
      position: absolute;
      top: 10px;
      left: 10px;
      border-radius: 5px;
      box-shadow: 0 0 10px #00ffcc;
      transition: top 0.1s, left 0.1s;
    }

    .goal {
      width: 40px;
      height: 40px;
      background: #ffcc00;
      position: absolute;
      border-radius: 8px;
      box-shadow: 0 0 15px #ffcc00;
    }

    .wall {
      position: absolute;
      background: #ff0044;
      box-shadow: 0 0 10px #ff0044;
    }

    #battery {
      margin-top: 20px;
      width: 300px;
      height: 20px;
      border: 2px solid #00ff99;
    }

    #battery-level {
      height: 100%;
      background-color: #00ff99;
      width: 100%;
      transition: width 0.2s;
    }

    #message {
      margin-top: 10px;
      font-size: 18px;
    }

    #credit {
      margin-top: 25px;
      font-family: 'Times New Roman', serif;
      font-style: italic;
      font-size: 20px;
      color: #d4af37;
      text-shadow: 0 0 10px #d4af37;
    }
  </style>
</head>
<body>
  <h1>🔋 The Last Battery</h1>
  <div id="game">
    <div class="robot" id="robot"></div>
    <div class="goal"></div>
  </div>

  <div id="battery">
    <div id="battery-level"></div>
  </div>
  <p id="message">Use arrow keys to move.</p>
  <p id="credit">Made by “Shlok the Great”</p>

  <script>
    const robot = document.getElementById("robot");
    const goal = document.querySelector(".goal");
    const game = document.getElementById("game");
    const batteryBar = document.getElementById("battery-level");
    const message = document.getElementById("message");

    let battery = 100;
    let x = 10;
    let y = 10;
    const speed = 10;
    let currentLevel = 1;
    const totalLevels = 10;

    // Levels: goal positions and walls.
    // NOTE: Level 10 has a gap in the top wall so the goal is reachable.
    const levels = [
      { goal: {x: 350, y: 350}, walls: [] },
      { goal: {x: 300, y: 350}, walls: [{x:100,y:100,w:200,h:20}] },
      { goal: {x: 350, y: 50}, walls: [{x:150,y:150,w:20,h:200}] },
      { goal: {x: 50, y: 350}, walls: [{x:50,y:100,w:300,h:20},{x:150,y:200,w:20,h:200}] },
      { goal: {x: 350, y: 200}, walls: [{x:50,y:150,w:300,h:20},{x:100,y:250,w:200,h:20}] },
      { goal: {x: 200, y: 350}, walls: [{x:0,y:100,w:380,h:20},{x:100,y:200,w:20,h:200}] },
      { goal: {x: 350, y: 100}, walls: [{x:100,y:50,w:20,h:300},{x:200,y:100,w:200,h:20}] },
      { goal: {x: 50, y:200}, walls: [{x:50,y:100,w:300,h:20},{x:50,y:300,w:300,h:20}] },
      { goal: {x: 350, y:350}, walls: [{x:0,y:150,w:350,h:20},{x:50,y:250,w:350,h:20}] },
      // Level 10 (fixed): walls form a box but the top wall is split so there's an entrance gap.
      { goal: {x: 200, y:200}, walls: [
          {x:100,y:100,w:80,h:20},   // top-left segment (100 -> 180)
          {x:220,y:100,w:80,h:20},   // top-right segment (220 -> 300) -- leaves gap 180->220
          {x:100,y:280,w:200,h:20},  // bottom
          {x:100,y:100,w:20,h:200},  // left vertical
          {x:280,y:100,w:20,h:200}   // right vertical
        ]
      }
    ];

    function setupLevel() {
      game.querySelectorAll(".wall").forEach(w => w.remove());
      const lvl = levels[currentLevel - 1];
      goal.style.left = lvl.goal.x + "px";
      goal.style.top = lvl.goal.y + "px";
      lvl.walls.forEach(w => {
        const wall = document.createElement("div");
        wall.className = "wall";
        wall.style.left = w.x + "px";
        wall.style.top = w.y + "px";
        wall.style.width = w.w + "px";
        wall.style.height = w.h + "px";
        game.appendChild(wall);
      });
      x = 10; y = 10;
      robot.style.left = x + "px";
      robot.style.top = y + "px";
      battery = 100;
      batteryBar.style.width = battery + "%";
      batteryBar.style.backgroundColor = "#00ff99";
      message.textContent = "Level " + currentLevel + " - Use arrow keys to move.";
    }

    function rectsOverlap(a, b) {
      return a.right > b.left && a.left < b.right && a.bottom > b.top && a.top < b.bottom;
    }

    document.addEventListener("keydown", (e) => {
      if (battery <= 0) return;
      const prevX = x, prevY = y;

      if (e.key === "ArrowUp" && y > 0) y -= speed;
      if (e.key === "ArrowDown" && y < 370) y += speed;
      if (e.key === "ArrowLeft" && x > 0) x -= speed;
      if (e.key === "ArrowRight" && x < 370) x += speed;

      robot.style.left = x + "px";
      robot.style.top = y + "px";
      battery -= 1;
      batteryBar.style.width = battery + "%";

      const robotRect = robot.getBoundingClientRect();
      const goalRect = goal.getBoundingClientRect();
      const walls = document.querySelectorAll(".wall");

      // Collision with walls
      for (let w of walls) {
        const wallRect = w.getBoundingClientRect();
        if (rectsOverlap(robotRect, wallRect)) {
          // revert to previous position if collided
          x = prevX;
          y = prevY;
          robot.style.left = x + "px";
          robot.style.top = y + "px";
          break;
        }
      }

      if (battery <= 0) {
        message.textContent = "⚠️ Battery Depleted! Game Over.";
        batteryBar.style.backgroundColor = "red";
        return;
      }

      // Goal reached
      if (rectsOverlap(robotRect, goalRect)) {
        if (currentLevel < totalLevels) {
          currentLevel++;
          message.textContent = "✅ Level Complete! Loading next...";
          setTimeout(setupLevel, 800);
        } else {
          message.textContent = "🏆 You saved the world, Shlok the Great!";
          batteryBar.style.backgroundColor = "#ffd700";
        }
      }
    });

    setupLevel();
  </script>
</body>
</html>
